# Generated by Anaconda 34.25.1.14
# Generated by pykickstart v3.32
#version=RHEL9
# Use text install
text

eula --agreed

url --url http://repo.karl.lab/BaseOS/x86_64/os/

repo --name=lab-baseos --baseurl=http://repo.karl.lab/BaseOS/x86_64/os/ --install
repo --name=lab-appstream --baseurl=http://repo.karl.lab/AppStream/x86_64/os/ --install
repo --name=lab-extras --baseurl=http://repo.karl.lab/extras/x86_64/os/ --install

%addon com_redhat_kdump --enable --reserve-mb='auto'

%end

# Keyboard layouts
keyboard --xlayouts='us'
# System language
lang en_US.UTF-8

# Network information
network  --bootproto=dhcp --device=ens33 --ipv6=ignore --activate

# packages to install
%packages
@^minimal-environment
@guest-agents

bash-completion
epel-release
vim

dracut-fips

# packages to exclude
-iw

%end

# do not Run the Setup Agent on first boot
firstboot --disabled

# ignore all disks and use only sda
ignoredisk --only-use=sda
autopart
# Partition clearing information
clearpart --all --initlabel

bootloader --location mbr --append "fips=1"

# set ntp server
timesource --ntp-server=192.168.0.1

# System timezone
timezone Etc/UTC --utc

# Root password
rootpw --iscrypted $6$f70vw2NoZLq9Q6mZ$hdidbqTVIK5DmlOsdkepHBwrVyVCNYe5JB4YTdGORrN91Eoz0rnsAtpc.uUdoivboTyghDXmYe8DADbC1hodc.
user --groups=wheel --name=karl --password=$6$G9JMI7eUAIJuHJYL$VTvbDzCjHzV6o3k3QG.dnuQQ6g.usI78NBcPuX6v2tx4RSKvon9zNDU5QSq4JVEbvJ93IPKmmBP2hQaih0ctp. --iscrypted

skipx


%post --log=/root/ks-post.log

# disable default repos since it's using the lan repo
dnf config-manager --set-disabled appstream
dnf config-manager --set-disabled baseos
dnf config-manager --set-disabled extras

# disable gpg check for repos
sed -i 's/^gpgcheck.*//g' /etc/yum.repos.d/* && sed -i 's/enabled=1/enabled=1 \ngpgcheck=0\n/g' /etc/yum.repos.d/*

%end





reboot --eject